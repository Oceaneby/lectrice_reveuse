{% extends 'base.html.twig' %}

{% block title %}Book{% endblock %}

{% block body %}
    <div class="container mx-auto p-8">
        <div class="bg-white p-6 rounded-lg shadow-lg">
            <div class="flex flex-col md:flex-row">
                <div class="flex-none w-full md:w-1/3">
                    <img src="{{ asset('uploads/book_cover/' ~ book.coverImage) }}" alt="{{ book.title }}" class="w-full h-auto rounded-lg shadow-lg">
                </div>

                <div class="md:ml-6 mt-4 md:mt-0 flex flex-col justify-between w-full md:w-2/3">
                    <h1 class="text-4xl font-semibold text-gray-800">{{ book.title }}</h1>
                    <p class="text-lg mt-4 text-gray-600">{{ book.description }}</p>

                    <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-6">
                        <div class="flex flex-col">
                            <span class="font-semibold text-gray-700">Auteur :</span>
                            <span class="text-gray-600">{{ book.author.firstName }} {{ book.author.lastName }}</span>
                        </div>
                        <div class="flex flex-col">
                            <span class="font-semibold text-gray-700">Maison d'édition :</span>
                            <span class="text-gray-600">{{ book.publisher.name }}</span>
                        </div>
                        <div class="flex flex-col">
                            <span class="font-semibold text-gray-700">Genre :</span>
                            <span class="text-gray-600">
                                {% for genre in book.genres %}
                                    {{ genre.name }}{% if not loop.last %}, {% endif %}
                                {% endfor %}
                            </span>
                        </div>
                        <div class="flex flex-col">
                            <span class="font-semibold text-gray-700">Date de publication :</span>
                            <span class="text-gray-600">{{ book.publicationDate ? book.publicationDate|date('d M Y') : 'Non renseignée' }}</span>
                        </div>
                        {% if book.isbn %}
                            <div class="flex flex-col">
                                <span class="font-semibold text-gray-700">ISBN :</span>
                                <span class="text-gray-600">{{ book.isbn }}</span>
                            </div>
                        {% endif %}
                    </div>

                    <!-- Ajout d'un conteneur flex pour les boutons -->
                    <div class="mt-6 flex space-x-4">
                        {% if book.amazonUrl %}
                            <a href="{{ book.amazonUrl }}" target="_blank" class="bg-yellow-400 text-black px-6 py-2 rounded-md hover:bg-yellow-500 transition duration-300 text-lg text-center">
                                Acheter sur Amazon
                            </a>
                        {% endif %}
                        {% if book.fnacUrl %}
                            <a href="{{ book.fnacUrl }}" target="_blank" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition duration-300 text-lg text-center">
                                Acheter sur Fnac
                            </a>
                        {% endif %}
                        {% if app.user %}
                            <!-- Bouton d'ajout à la bibliothèque si l'utilisateur est connecté -->
                            <form action="{{ path('app_library_add', {'bookId': book.id}) }}" method="POST" class="flex items-center">
                                <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 transition duration-300 text-lg text-center">
                                    Ajouter à ma bibliothèque
                                </button>
                            </form>
                        {% endif %}
                    </div>

                    {% if isAdmin %}
                        <div class="mt-6 text-center">
                            <a href="{{ path('app_book_edit', {'id': book.id}) }}" class="bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 transition duration-300">
                                Modifier ce livre
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="mt-8 text-center">
            <a href="{{ path('app_home') }}" class="text-blue-500 hover:underline text-lg">
                Retour à la liste des livres
            </a>
        </div>
    </div>

{% endblock %}
